import{Ha as m,Q as c,aa as u,ba as l,ca as d}from"./chunk-VURGYMKM.js";var p=class a{options={startingHue:120,clickLimiter:5,timerInterval:40,showTargets:!0,rocketSpeed:2,rocketAcceleration:1.03,particleFriction:.95,particleGravity:1,particleMinCount:25,particleMaxCount:40,particleMinRadius:3,particleMaxRadius:5};fireworks=[];particles=[];mouse={down:!1,x:0,y:0};currentHue=this.options.startingHue;clickLimiterTick=0;timerTick=0;cntRocketsLaunched=0;canvas;canvasCtx;canvasWidth;canvasHeight;animationFrameId=0;ngAfterViewInit(){this.initFireworks()}ngOnDestroy(){window.removeEventListener("resize",this.onResize),this.canvas.removeEventListener("mousemove",this.onMouseMove),this.canvas.removeEventListener("mousedown",this.onMouseDown),this.canvas.removeEventListener("mouseup",this.onMouseUp),cancelAnimationFrame(this.animationFrameId)}initFireworks(){this.canvas=document.getElementById("canvas"),this.canvasWidth=window.innerWidth,this.canvasHeight=window.innerHeight,this.canvasCtx=this.canvas.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.onResize),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mouseup",this.onMouseUp),this.gameLoop(),console.log("gameLoop tick",this.fireworks.length,this.particles.length,this.timerTick)}onResize=()=>{this.canvasWidth=window.innerWidth,this.canvasHeight=window.innerHeight,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight};onMouseMove=t=>{t.preventDefault(),this.mouse.x=t.pageX-this.canvas.offsetLeft,this.mouse.y=t.pageY-this.canvas.offsetTop};onMouseDown=t=>{t.preventDefault(),this.mouse.down=!0};onMouseUp=t=>{t.preventDefault(),this.mouse.down=!1};resizeCanvas(){this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight}random(t,e){return Math.random()*(e-t)+t}calculateDistance(t,e,i,s){let n=t-i,h=e-s;return Math.sqrt(n*n+h*h)}createParticles=(t,e)=>{let i=Math.round(this.random(this.options.particleMinCount,this.options.particleMaxCount));for(let s=0;s<i;s++)this.particles.push(new o(t,e,this))};gameLoop=()=>{this.animationFrameId=requestAnimationFrame(this.gameLoop),this.currentHue+=.5,this.canvasCtx.globalCompositeOperation="destination-out",this.canvasCtx.fillStyle="rgb(0, 0, 0)",this.canvasCtx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.canvasCtx.globalCompositeOperation="lighter";for(let t=this.fireworks.length-1;t>=0;t--)this.fireworks[t].draw(),this.fireworks[t].update(t);for(let t=this.particles.length-1;t>=0;t--)this.particles[t].draw(),this.particles[t].update(t);this.canvasCtx.fillStyle="white",this.canvasCtx.font="20px Arial",this.timerTick>=this.options.timerInterval?this.mouse.down||(this.fireworks.push(new r(this.canvasWidth/2,this.canvasHeight,this.random(0,this.canvasWidth),this.random(0,this.canvasHeight/2),this)),this.timerTick=0):this.timerTick++,this.clickLimiterTick>=this.options.clickLimiter?this.mouse.down&&(this.fireworks.push(new r(this.canvasWidth/2,this.canvasHeight,this.mouse.x,this.mouse.y,this)),this.clickLimiterTick=0):this.clickLimiterTick++};static \u0275fac=function(e){return new(e||a)};static \u0275cmp=c({type:a,selectors:[["app-background-canvas"]],decls:3,vars:0,consts:[["id","canvas"]],template:function(e,i){e&1&&(u(0,"div"),d(1,"canvas",0)(2,"router-outlet"),l())},dependencies:[m],styles:["canvas[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1;pointer-events:visible;background:#000;background-size:cover}"]})},r=class{x;y;sx;sy;tx;ty;distanceToTarget;distanceTraveled;coordinates;coordinateCount;angle;speed;acceleration;brightness;hue;targetRadius;targetDirection;app;constructor(t,e,i,s,n){for(this.app=n,this.x=this.sx=t,this.y=this.sy=e,this.tx=i,this.ty=s,this.distanceToTarget=n.calculateDistance(t,e,i,s),this.distanceTraveled=0,this.coordinateCount=3,this.coordinates=[];this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=Math.atan2(s-e,i-t),this.speed=n.options.rocketSpeed,this.acceleration=n.options.rocketAcceleration,this.brightness=n.random(100,100),this.hue=n.currentHue,this.targetRadius=1,this.targetDirection=!1,n.cntRocketsLaunched++}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.targetDirection?this.targetRadius>1?this.targetRadius-=.15:this.targetDirection=!1:this.targetRadius<10?this.targetRadius+=.15:this.targetDirection=!0,this.speed*=this.acceleration;let e=Math.cos(this.angle)*this.speed,i=Math.sin(this.angle)*this.speed;this.distanceTraveled=this.app.calculateDistance(this.sx,this.sy,this.x+e,this.y+i),this.distanceTraveled>=this.distanceToTarget?(this.app.createParticles(this.tx,this.ty),this.app.fireworks.splice(t,1)):(this.x+=e,this.y+=i)}draw(){let t=this.app.canvasCtx,e=this.coordinates[this.coordinates.length-1];t.beginPath(),t.moveTo(e[0],e[1]),t.lineTo(this.x,this.y),t.strokeStyle=`hsl(${this.hue},100%,${this.brightness}%)`,t.stroke(),this.app.options.showTargets&&(t.beginPath(),t.arc(this.tx,this.ty,this.targetRadius,0,Math.PI*2),t.stroke())}},o=class{x;y;coordinates;coordinateCount;angle;speed;friction;gravity;hue;brightness;alpha;decay;app;constructor(t,e,i){for(this.app=i,this.x=t,this.y=e,this.coordinateCount=5,this.coordinates=[];this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=i.random(0,Math.PI*2),this.speed=i.random(1,10),this.friction=i.options.particleFriction,this.gravity=i.options.particleGravity,this.hue=i.random(i.currentHue-20,i.currentHue+20),this.brightness=i.random(50,80),this.alpha=1,this.decay=i.random(.01,.03)}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&this.app.particles.splice(t,1)}draw(){let t=this.app.canvasCtx,e=this.coordinates[this.coordinates.length-1],i=Math.round(this.app.random(this.app.options.particleMinRadius,this.app.options.particleMaxRadius)),s=t.createRadialGradient(this.x,this.y,2,this.x,this.y,i);s.addColorStop(0,"white"),s.addColorStop(.2,"white"),s.addColorStop(1,"black"),t.beginPath(),t.fillStyle=s,t.arc(this.x,this.y,i,-2,Math.PI*2,!1),t.fill()}};export{p as a};
