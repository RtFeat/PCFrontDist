import{$ as K,B as L,C as G,D as R,H as N,K as C,L as D,M as F,N as A,T as I,U as J,V as O,W as P,X as Z,c as W,i as q,o as j,q as z,s as k,t as V,x as M,y as B}from"./chunk-GSMEW25H.js";var Q=class extends O{constructor(t){super(t)}load(t,s,r,e){let i=this,c=this.path===""?K.extractUrlBase(t):this.path,a=new P(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(n){try{s(i.parse(n,c))}catch(o){e?e(o):console.error(o),i.manager.itemError(t)}},r,e)}setMaterialOptions(t){return this.materialOptions=t,this}parse(t,s){let r=t.split(`
`),e={},i=/\s+/,c={};for(let n=0;n<r.length;n++){let o=r[n];if(o=o.trim(),o.length===0||o.charAt(0)==="#")continue;let h=o.indexOf(" "),l=h>=0?o.substring(0,h):o;l=l.toLowerCase();let p=h>=0?o.substring(h+1):"";if(p=p.trim(),l==="newmtl")e={name:p},c[p]=e;else if(l==="ka"||l==="kd"||l==="ks"||l==="ke"){let u=p.split(i,3);e[l]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else e[l]=p}let a=new T(this.resourcePath||s,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(c),a}},T=class{constructor(t="",s={}){this.baseUrl=t,this.options=s,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:W,this.wrap=this.options.wrap!==void 0?this.options.wrap:q}setCrossOrigin(t){return this.crossOrigin=t,this}setManager(t){this.manager=t}setMaterials(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(t){if(!this.options)return t;let s={};for(let r in t){let e=t[r],i={};s[r]=i;for(let c in e){let a=!0,n=e[c],o=c.toLowerCase();switch(o){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&n[0]===0&&n[1]===0&&n[2]===0&&(a=!1);break;default:break}a&&(i[o]=n)}}return s}preload(){for(let t in this.materialsInfo)this.create(t)}getIndex(t){return this.nameLookup[t]}getAsArray(){let t=0;for(let s in this.materialsInfo)this.materialsArray[t]=this.create(s),this.nameLookup[s]=t,t++;return this.materialsArray}create(t){return this.materials[t]===void 0&&this.createMaterial_(t),this.materials[t]}createMaterial_(t){let s=this,r=this.materialsInfo[t],e={name:t,side:this.side};function i(a,n){return typeof n!="string"||n===""?"":/^https?:\/\//i.test(n)?n:a+n}function c(a,n){if(e[a])return;let o=s.getTextureParams(n,e),h=s.loadTexture(i(s.baseUrl,o.url));h.repeat.copy(o.scale),h.offset.copy(o.offset),h.wrapS=s.wrap,h.wrapT=s.wrap,(a==="map"||a==="emissiveMap")&&(h.colorSpace=j),e[a]=h}for(let a in r){let n=r[a],o;if(n!=="")switch(a.toLowerCase()){case"kd":e.color=V.colorSpaceToWorking(new M().fromArray(n),j);break;case"ks":e.specular=V.colorSpaceToWorking(new M().fromArray(n),j);break;case"ke":e.emissive=V.colorSpaceToWorking(new M().fromArray(n),j);break;case"map_kd":c("map",n);break;case"map_ks":c("specularMap",n);break;case"map_ke":c("emissiveMap",n);break;case"norm":c("normalMap",n);break;case"map_bump":case"bump":c("bumpMap",n);break;case"disp":c("displacementMap",n);break;case"map_d":c("alphaMap",n),e.transparent=!0;break;case"ns":e.shininess=parseFloat(n);break;case"d":o=parseFloat(n),o<1&&(e.opacity=o,e.transparent=!0);break;case"tr":o=parseFloat(n),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(e.opacity=1-o,e.transparent=!0);break;default:break}}return this.materials[t]=new I(e),this.materials[t]}getTextureParams(t,s){let r={scale:new z(1,1),offset:new z(0,0)},e=t.split(/\s+/),i;return i=e.indexOf("-bm"),i>=0&&(s.bumpScale=parseFloat(e[i+1]),e.splice(i,2)),i=e.indexOf("-mm"),i>=0&&(s.displacementBias=parseFloat(e[i+1]),s.displacementScale=parseFloat(e[i+2]),e.splice(i,3)),i=e.indexOf("-s"),i>=0&&(r.scale.set(parseFloat(e[i+1]),parseFloat(e[i+2])),e.splice(i,4)),i=e.indexOf("-o"),i>=0&&(r.offset.set(parseFloat(e[i+1]),parseFloat(e[i+2])),e.splice(i,4)),r.url=e.join(" ").trim(),r}loadTexture(t,s,r,e,i){let c=this.manager!==void 0?this.manager:J,a=c.getHandler(t);a===null&&(a=new Z(c)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);let n=a.load(t,r,e,i);return s!==void 0&&(n.mapping=s),n}};var se=/^[og]\s*(.+)?/,ie=/^mtllib /,re=/^usemtl /,ne=/^usemap /,X=/\s+/,Y=new k,E=new k,$=new k,ee=new k,x=new k,U=new M;function oe(){let _={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,s){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=s!==!1;return}let r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:s!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,i){let c=this._finalize(!1);c&&(c.inherited||c.groupCount<=0)&&this.materials.splice(c.index,1);let a={index:this.materials.length,name:e||"",mtllib:Array.isArray(i)&&i.length>0?i[i.length-1]:"",smooth:c!==void 0?c.smooth:this.smooth,groupStart:c!==void 0?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(n){let o={index:typeof n=="number"?n:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return o.clone=this.clone.bind(o),o}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){let i=this.currentMaterial();if(i&&i.groupEnd===-1&&(i.groupEnd=this.geometry.vertices.length/3,i.groupCount=i.groupEnd-i.groupStart,i.inherited=!1),e&&this.materials.length>1)for(let c=this.materials.length-1;c>=0;c--)this.materials[c].groupCount<=0&&this.materials.splice(c,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),i}},r&&r.name&&typeof r.clone=="function"){let e=r.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,s){let r=parseInt(t,10);return(r>=0?r-1:r+s/3)*3},parseNormalIndex:function(t,s){let r=parseInt(t,10);return(r>=0?r-1:r+s/3)*3},parseUVIndex:function(t,s){let r=parseInt(t,10);return(r>=0?r-1:r+s/2)*2},addVertex:function(t,s,r){let e=this.vertices,i=this.object.geometry.vertices;i.push(e[t+0],e[t+1],e[t+2]),i.push(e[s+0],e[s+1],e[s+2]),i.push(e[r+0],e[r+1],e[r+2])},addVertexPoint:function(t){let s=this.vertices;this.object.geometry.vertices.push(s[t+0],s[t+1],s[t+2])},addVertexLine:function(t){let s=this.vertices;this.object.geometry.vertices.push(s[t+0],s[t+1],s[t+2])},addNormal:function(t,s,r){let e=this.normals,i=this.object.geometry.normals;i.push(e[t+0],e[t+1],e[t+2]),i.push(e[s+0],e[s+1],e[s+2]),i.push(e[r+0],e[r+1],e[r+2])},addFaceNormal:function(t,s,r){let e=this.vertices,i=this.object.geometry.normals;Y.fromArray(e,t),E.fromArray(e,s),$.fromArray(e,r),x.subVectors($,E),ee.subVectors(Y,E),x.cross(ee),x.normalize(),i.push(x.x,x.y,x.z),i.push(x.x,x.y,x.z),i.push(x.x,x.y,x.z)},addColor:function(t,s,r){let e=this.colors,i=this.object.geometry.colors;e[t]!==void 0&&i.push(e[t+0],e[t+1],e[t+2]),e[s]!==void 0&&i.push(e[s+0],e[s+1],e[s+2]),e[r]!==void 0&&i.push(e[r+0],e[r+1],e[r+2])},addUV:function(t,s,r){let e=this.uvs,i=this.object.geometry.uvs;i.push(e[t+0],e[t+1]),i.push(e[s+0],e[s+1]),i.push(e[r+0],e[r+1])},addDefaultUV:function(){let t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){let s=this.uvs;this.object.geometry.uvs.push(s[t+0],s[t+1])},addFace:function(t,s,r,e,i,c,a,n,o){let h=this.vertices.length,l=this.parseVertexIndex(t,h),p=this.parseVertexIndex(s,h),u=this.parseVertexIndex(r,h);if(this.addVertex(l,p,u),this.addColor(l,p,u),a!==void 0&&a!==""){let m=this.normals.length;l=this.parseNormalIndex(a,m),p=this.parseNormalIndex(n,m),u=this.parseNormalIndex(o,m),this.addNormal(l,p,u)}else this.addFaceNormal(l,p,u);if(e!==void 0&&e!==""){let m=this.uvs.length;l=this.parseUVIndex(e,m),p=this.parseUVIndex(i,m),u=this.parseUVIndex(c,m),this.addUV(l,p,u),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";let s=this.vertices.length;for(let r=0,e=t.length;r<e;r++){let i=this.parseVertexIndex(t[r],s);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(t,s){this.object.geometry.type="Line";let r=this.vertices.length,e=this.uvs.length;for(let i=0,c=t.length;i<c;i++)this.addVertexLine(this.parseVertexIndex(t[i],r));for(let i=0,c=s.length;i<c;i++)this.addUVLine(this.parseUVIndex(s[i],e))}};return _.startObject("",!1),_}var te=class extends O{constructor(t){super(t),this.materials=null}load(t,s,r,e){let i=this,c=new P(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(t,function(a){try{s(i.parse(a))}catch(n){e?e(n):console.error(n),i.manager.itemError(t)}},r,e)}setMaterials(t){return this.materials=t,this}parse(t){let s=new oe;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));let r=t.split(`
`),e=[];for(let a=0,n=r.length;a<n;a++){let o=r[a].trimStart();if(o.length===0)continue;let h=o.charAt(0);if(h!=="#")if(h==="v"){let l=o.split(X);switch(l[0]){case"v":s.vertices.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])),l.length>=7?(U.setRGB(parseFloat(l[4]),parseFloat(l[5]),parseFloat(l[6]),j),s.colors.push(U.r,U.g,U.b)):s.colors.push(void 0,void 0,void 0);break;case"vn":s.normals.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case"vt":s.uvs.push(parseFloat(l[1]),parseFloat(l[2]));break}}else if(h==="f"){let p=o.slice(1).trim().split(X),u=[];for(let f=0,g=p.length;f<g;f++){let b=p[f];if(b.length>0){let v=b.split("/");u.push(v)}}let m=u[0];for(let f=1,g=u.length-1;f<g;f++){let b=u[f],v=u[f+1];s.addFace(m[0],b[0],v[0],m[1],b[1],v[1],m[2],b[2],v[2])}}else if(h==="l"){let l=o.substring(1).trim().split(" "),p=[],u=[];if(o.indexOf("/")===-1)p=l;else for(let m=0,f=l.length;m<f;m++){let g=l[m].split("/");g[0]!==""&&p.push(g[0]),g[1]!==""&&u.push(g[1])}s.addLineGeometry(p,u)}else if(h==="p"){let p=o.slice(1).trim().split(" ");s.addPointGeometry(p)}else if((e=se.exec(o))!==null){let l=(" "+e[0].slice(1).trim()).slice(1);s.startObject(l)}else if(re.test(o))s.object.startMaterial(o.substring(7).trim(),s.materialLibraries);else if(ie.test(o))s.materialLibraries.push(o.substring(7).trim());else if(ne.test(o))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(h==="s"){if(e=o.split(" "),e.length>1){let p=e[1].trim().toLowerCase();s.object.smooth=p!=="0"&&p!=="off"}else s.object.smooth=!0;let l=s.object.currentMaterial();l&&(l.smooth=s.object.smooth)}else{if(o==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+o+'"')}}s.finalize();let i=new N;if(i.materialLibraries=[].concat(s.materialLibraries),!(s.objects.length===1&&s.objects[0].geometry.vertices.length===0)===!0)for(let a=0,n=s.objects.length;a<n;a++){let o=s.objects[a],h=o.geometry,l=o.materials,p=h.type==="Line",u=h.type==="Points",m=!1;if(h.vertices.length===0)continue;let f=new G;f.setAttribute("position",new L(h.vertices,3)),h.normals.length>0&&f.setAttribute("normal",new L(h.normals,3)),h.colors.length>0&&(m=!0,f.setAttribute("color",new L(h.colors,3))),h.hasUVIndices===!0&&f.setAttribute("uv",new L(h.uvs,2));let g=[];for(let v=0,S=l.length;v<S;v++){let y=l[v],H=y.name+"_"+y.smooth+"_"+m,d=s.materials[H];if(this.materials!==null){if(d=this.materials.create(y.name),p&&d&&!(d instanceof C)){let w=new C;B.prototype.copy.call(w,d),w.color.copy(d.color),d=w}else if(u&&d&&!(d instanceof F)){let w=new F({size:10,sizeAttenuation:!1});B.prototype.copy.call(w,d),w.color.copy(d.color),w.map=d.map,d=w}}d===void 0&&(p?d=new C:u?d=new F({size:1,sizeAttenuation:!1}):d=new I,d.name=y.name,d.flatShading=!y.smooth,d.vertexColors=m,s.materials[H]=d),g.push(d)}let b;if(g.length>1){for(let v=0,S=l.length;v<S;v++){let y=l[v];f.addGroup(y.groupStart,y.groupCount,v)}p?b=new D(f,g):u?b=new A(f,g):b=new R(f,g)}else p?b=new D(f,g[0]):u?b=new A(f,g[0]):b=new R(f,g[0]);b.name=o.name,i.add(b)}else if(s.vertices.length>0){let a=new F({size:1,sizeAttenuation:!1}),n=new G;n.setAttribute("position",new L(s.vertices,3)),s.colors.length>0&&s.colors[0]!==void 0&&(n.setAttribute("color",new L(s.colors,3)),a.vertexColors=!0);let o=new A(n,a);i.add(o)}return i}};export{Q as a,te as b};
